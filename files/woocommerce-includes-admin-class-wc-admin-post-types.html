<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>WooCommerce Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1692866946">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1692866946">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.svg" alt="WooCommerce" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">WooCommerce Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/woocommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/woocommerce-admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/automattic-woocommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WooCommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WooCommerce-Classes.html"><abbr title="\WooCommerce\Classes">Classes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Abstracts.html"><abbr title="\WooCommerce\Abstracts">Abstracts</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Helper.html"><abbr title="\WooCommerce\Helper">Helper</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Views.html"><abbr title="\WooCommerce\Views">Views</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Templates.html"><abbr title="\WooCommerce\Templates">Templates</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Reports.html"><abbr title="\WooCommerce\Reports">Reports</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Blocks.html"><abbr title="\WooCommerce\Blocks">Blocks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-RestApi.html"><abbr title="\WooCommerce\RestApi">RestApi</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-CLI.html"><abbr title="\WooCommerce\CLI">CLI</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-l10n.html"><abbr title="\WooCommerce\l10n">l10n</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Webhooks.html"><abbr title="\WooCommerce\Webhooks">Webhooks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-DataStores.html"><abbr title="\WooCommerce\DataStores">DataStores</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Emails.html"><abbr title="\WooCommerce\Emails">Emails</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Export.html"><abbr title="\WooCommerce\Export">Export</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Gateways.html"><abbr title="\WooCommerce\Gateways">Gateways</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PayPal.html"><abbr title="\WooCommerce\PayPal">PayPal</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Import.html"><abbr title="\WooCommerce\Import">Import</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Integrations.html"><abbr title="\WooCommerce\Integrations">Integrations</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interfaces.html"><abbr title="\WooCommerce\Interfaces">Interfaces</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interface.html"><abbr title="\WooCommerce\Interface">Interface</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-LogHandlers.html"><abbr title="\WooCommerce\LogHandlers">LogHandlers</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PaymentTokens.html"><abbr title="\WooCommerce\PaymentTokens">PaymentTokens</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Utilities.html"><abbr title="\WooCommerce\Utilities">Utilities</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shipping.html"><abbr title="\WooCommerce\Shipping">Shipping</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shortcodes.html"><abbr title="\WooCommerce\Shortcodes">Shortcodes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Tracks.html"><abbr title="\WooCommerce\Tracks">Tracks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Traits.html"><abbr title="\WooCommerce\Traits">Traits</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Functions.html"><abbr title="\WooCommerce\Functions">Functions</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCom.html"><abbr title="\WooCommerce\WCCom">WCCom</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCOM.html"><abbr title="\WooCommerce\WCCOM">WCCOM</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Widgets.html"><abbr title="\WooCommerce\Widgets">Widgets</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Uninstaller.html"><abbr title="\WooCommerce\Uninstaller">Uninstaller</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceAdmin.html"><abbr title="\WoocommerceAdmin">WoocommerceAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceNavigation.html"><abbr title="\WoocommerceNavigation">WoocommerceNavigation</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/Automattic-WooCommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-wc-admin-post-types.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * Post Types Admin
 *
 * @package  WooCommerce\Admin
 * @version  3.3.0
 */

use Automattic\Jetpack\Constants;
use Automattic\WooCommerce\Utilities\NumberUtil;

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}

if ( class_exists( &#039;WC_Admin_Post_Types&#039;, false ) ) {
	new WC_Admin_Post_Types();
	return;
}

/**
 * WC_Admin_Post_Types Class.
 *
 * Handles the edit posts views and some functionality on the edit post screen for WC post types.
 */
class WC_Admin_Post_Types {

	/**
	 * Constructor.
	 */
	public function __construct() {
		include_once __DIR__ . &#039;/class-wc-admin-meta-boxes.php&#039;;

		if ( ! function_exists( &#039;duplicate_post_plugin_activation&#039; ) ) {
			include_once __DIR__ . &#039;/class-wc-admin-duplicate-product.php&#039;;
		}

		// Load correct list table classes for current screen.
		add_action( &#039;current_screen&#039;, array( $this, &#039;setup_screen&#039; ) );
		add_action( &#039;check_ajax_referer&#039;, array( $this, &#039;setup_screen&#039; ) );

		// Admin notices.
		add_filter( &#039;post_updated_messages&#039;, array( $this, &#039;post_updated_messages&#039; ) );
		add_filter( &#039;woocommerce_order_updated_messages&#039;, array( $this, &#039;order_updated_messages&#039; ) );
		add_filter( &#039;bulk_post_updated_messages&#039;, array( $this, &#039;bulk_post_updated_messages&#039; ), 10, 2 );

		// Disable Auto Save.
		add_action( &#039;admin_print_scripts&#039;, array( $this, &#039;disable_autosave&#039; ) );

		// Extra post data and screen elements.
		add_action( &#039;edit_form_top&#039;, array( $this, &#039;edit_form_top&#039; ) );
		add_filter( &#039;enter_title_here&#039;, array( $this, &#039;enter_title_here&#039; ), 1, 2 );
		add_action( &#039;edit_form_after_title&#039;, array( $this, &#039;edit_form_after_title&#039; ) );
		add_filter( &#039;default_hidden_meta_boxes&#039;, array( $this, &#039;hidden_meta_boxes&#039; ), 10, 2 );
		add_action( &#039;post_submitbox_misc_actions&#039;, array( $this, &#039;product_data_visibility&#039; ) );

		// Uploads.
		add_filter( &#039;upload_dir&#039;, array( $this, &#039;upload_dir&#039; ) );
		add_filter( &#039;wp_unique_filename&#039;, array( $this, &#039;update_filename&#039; ), 10, 3 );
		add_action( &#039;media_upload_downloadable_product&#039;, array( $this, &#039;media_upload_downloadable_product&#039; ) );

		// Hide template for CPT archive.
		add_filter( &#039;theme_page_templates&#039;, array( $this, &#039;hide_cpt_archive_templates&#039; ), 10, 3 );
		add_action( &#039;edit_form_top&#039;, array( $this, &#039;show_cpt_archive_notice&#039; ) );

		// Add a post display state for special WC pages.
		add_filter( &#039;display_post_states&#039;, array( $this, &#039;add_display_post_states&#039; ), 10, 2 );

		// Bulk / quick edit.
		add_action( &#039;bulk_edit_custom_box&#039;, array( $this, &#039;bulk_edit&#039; ), 10, 2 );
		add_action( &#039;quick_edit_custom_box&#039;, array( $this, &#039;quick_edit&#039; ), 10, 2 );
		add_action( &#039;save_post&#039;, array( $this, &#039;bulk_and_quick_edit_hook&#039; ), 10, 2 );
		add_action( &#039;woocommerce_product_bulk_and_quick_edit&#039;, array( $this, &#039;bulk_and_quick_edit_save_post&#039; ), 10, 2 );
	}

	/**
	 * Looks at the current screen and loads the correct list table handler.
	 *
	 * @since 3.3.0
	 */
	public function setup_screen() {
		global $wc_list_table;

		$request_data = $this-&gt;request_data();

		$screen_id = false;

		if ( function_exists( &#039;get_current_screen&#039; ) ) {
			$screen    = get_current_screen();
			$screen_id = isset( $screen, $screen-&gt;id ) ? $screen-&gt;id : &#039;&#039;;
		}

		if ( ! empty( $request_data[&#039;screen&#039;] ) ) {
			$screen_id = wc_clean( wp_unslash( $request_data[&#039;screen&#039;] ) );
		}

		switch ( $screen_id ) {
			case &#039;edit-shop_order&#039;:
				include_once __DIR__ . &#039;/list-tables/class-wc-admin-list-table-orders.php&#039;;
				$wc_list_table = new WC_Admin_List_Table_Orders();
				break;
			case &#039;edit-shop_coupon&#039;:
				include_once __DIR__ . &#039;/list-tables/class-wc-admin-list-table-coupons.php&#039;;
				$wc_list_table = new WC_Admin_List_Table_Coupons();
				break;
			case &#039;edit-product&#039;:
				include_once __DIR__ . &#039;/list-tables/class-wc-admin-list-table-products.php&#039;;
				$wc_list_table = new WC_Admin_List_Table_Products();
				break;
		}

		// Ensure the table handler is only loaded once. Prevents multiple loads if a plugin calls check_ajax_referer many times.
		remove_action( &#039;current_screen&#039;, array( $this, &#039;setup_screen&#039; ) );
		remove_action( &#039;check_ajax_referer&#039;, array( $this, &#039;setup_screen&#039; ) );
	}

	/**
	 * Change messages when a post type is updated.
	 *
	 * @param  array $messages Array of messages.
	 * @return array
	 */
	public function post_updated_messages( $messages ) {
		global $post;

		$messages[&#039;product&#039;] = array(
			0  =&gt; &#039;&#039;, // Unused. Messages start at index 1.
			/* translators: %1$s: Product link opening tag. %2$s: Product link closing tag.*/
			1  =&gt; sprintf( __( &#039;Product updated. %1$sView Product%2$s&#039;, &#039;woocommerce&#039; ), &#039;&lt;a id=&quot;woocommerce-product-updated-message-view-product__link&quot; href=&quot;&#039; . esc_url( get_permalink( $post-&gt;ID ) ) . &#039;&quot;&gt;&#039;, &#039;&lt;/a&gt;&#039; ),
			2  =&gt; __( &#039;Custom field updated.&#039;, &#039;woocommerce&#039; ),
			3  =&gt; __( &#039;Custom field deleted.&#039;, &#039;woocommerce&#039; ),
			4  =&gt; __( &#039;Product updated.&#039;, &#039;woocommerce&#039; ),
			5  =&gt; __( &#039;Revision restored.&#039;, &#039;woocommerce&#039; ),
			/* translators: %1$s: Product link opening tag. %2$s: Product link closing tag.*/
			6  =&gt; sprintf( __( &#039;Product published. %1$sView Product%2$s&#039;, &#039;woocommerce&#039; ), &#039;&lt;a id=&quot;woocommerce-product-updated-message-view-product__link&quot; href=&quot;&#039; . esc_url( get_permalink( $post-&gt;ID ) ) . &#039;&quot;&gt;&#039;, &#039;&lt;/a&gt;&#039; ),
			7  =&gt; __( &#039;Product saved.&#039;, &#039;woocommerce&#039; ),
			/* translators: %s: product url */
			8  =&gt; sprintf( __( &#039;Product submitted. &lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;Preview product&lt;/a&gt;&#039;, &#039;woocommerce&#039; ), esc_url( add_query_arg( &#039;preview&#039;, &#039;true&#039;, get_permalink( $post-&gt;ID ) ) ) ),
			9  =&gt; sprintf(
				/* translators: 1: date 2: product url */
				__( &#039;Product scheduled for: %1$s. &lt;a target=&quot;_blank&quot; href=&quot;%2$s&quot;&gt;Preview product&lt;/a&gt;&#039;, &#039;woocommerce&#039; ),
				&#039;&lt;strong&gt;&#039; . date_i18n( __( &#039;M j, Y @ G:i&#039;, &#039;woocommerce&#039; ), strtotime( $post-&gt;post_date ) ) . &#039;&lt;/strong&gt;&#039;,
				esc_url( get_permalink( $post-&gt;ID ) )
			),
			/* translators: %s: product url */
			10 =&gt; sprintf( __( &#039;Product draft updated. &lt;a target=&quot;_blank&quot; href=&quot;%s&quot;&gt;Preview product&lt;/a&gt;&#039;, &#039;woocommerce&#039; ), esc_url( add_query_arg( &#039;preview&#039;, &#039;true&#039;, get_permalink( $post-&gt;ID ) ) ) ),
		);

		$messages = $this-&gt;order_updated_messages( $messages );

		$messages[&#039;shop_coupon&#039;] = array(
			0  =&gt; &#039;&#039;, // Unused. Messages start at index 1.
			1  =&gt; __( &#039;Coupon updated.&#039;, &#039;woocommerce&#039; ),
			2  =&gt; __( &#039;Custom field updated.&#039;, &#039;woocommerce&#039; ),
			3  =&gt; __( &#039;Custom field deleted.&#039;, &#039;woocommerce&#039; ),
			4  =&gt; __( &#039;Coupon updated.&#039;, &#039;woocommerce&#039; ),
			5  =&gt; __( &#039;Revision restored.&#039;, &#039;woocommerce&#039; ),
			6  =&gt; __( &#039;Coupon updated.&#039;, &#039;woocommerce&#039; ),
			7  =&gt; __( &#039;Coupon saved.&#039;, &#039;woocommerce&#039; ),
			8  =&gt; __( &#039;Coupon submitted.&#039;, &#039;woocommerce&#039; ),
			9  =&gt; sprintf(
				/* translators: %s: date */
				__( &#039;Coupon scheduled for: %s.&#039;, &#039;woocommerce&#039; ),
				&#039;&lt;strong&gt;&#039; . date_i18n( __( &#039;M j, Y @ G:i&#039;, &#039;woocommerce&#039; ), strtotime( $post-&gt;post_date ) ) . &#039;&lt;/strong&gt;&#039;
			),
			10 =&gt; __( &#039;Coupon draft updated.&#039;, &#039;woocommerce&#039; ),
		);

		return $messages;
	}

	/**
	 * Add messages when an order is updated.
	 *
	 * @param array $messages Array of messages.
	 *
	 * @return array
	 */
	public function order_updated_messages( array $messages ) {
		global $post, $theorder;

		if ( ! isset( $theorder ) || ! $theorder instanceof WC_Abstract_Order ) {
			if ( ! isset( $post ) || &#039;shop_order&#039; !== $post-&gt;post_type ) {
				return $messages;
			} else {
				\Automattic\WooCommerce\Utilities\OrderUtil::init_theorder_object( $post );
			}
		}

		$messages[&#039;shop_order&#039;] = array(
			0  =&gt; &#039;&#039;, // Unused. Messages start at index 1.
			1  =&gt; __( &#039;Order updated.&#039;, &#039;woocommerce&#039; ),
			2  =&gt; __( &#039;Custom field updated.&#039;, &#039;woocommerce&#039; ),
			3  =&gt; __( &#039;Custom field deleted.&#039;, &#039;woocommerce&#039; ),
			4  =&gt; __( &#039;Order updated.&#039;, &#039;woocommerce&#039; ),
			5  =&gt; __( &#039;Revision restored.&#039;, &#039;woocommerce&#039; ),
			6  =&gt; __( &#039;Order updated.&#039;, &#039;woocommerce&#039; ),
			7  =&gt; __( &#039;Order saved.&#039;, &#039;woocommerce&#039; ),
			8  =&gt; __( &#039;Order submitted.&#039;, &#039;woocommerce&#039; ),
			9  =&gt; sprintf(
			/* translators: %s: date */
				__( &#039;Order scheduled for: %s.&#039;, &#039;woocommerce&#039; ),
				&#039;&lt;strong&gt;&#039; . date_i18n( __( &#039;M j, Y @ G:i&#039;, &#039;woocommerce&#039; ), strtotime( $theorder-&gt;get_date_created() ) ) . &#039;&lt;/strong&gt;&#039;
			),
			10 =&gt; __( &#039;Order draft updated.&#039;, &#039;woocommerce&#039; ),
			11 =&gt; __( &#039;Order updated and sent.&#039;, &#039;woocommerce&#039; ),
		);

		return $messages;
	}

	/**
	 * Specify custom bulk actions messages for different post types.
	 *
	 * @param  array $bulk_messages Array of messages.
	 * @param  array $bulk_counts Array of how many objects were updated.
	 * @return array
	 */
	public function bulk_post_updated_messages( $bulk_messages, $bulk_counts ) {
		$bulk_messages[&#039;product&#039;] = array(
			/* translators: %s: product count */
			&#039;updated&#039;   =&gt; _n( &#039;%s product updated.&#039;, &#039;%s products updated.&#039;, $bulk_counts[&#039;updated&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: product count */
			&#039;locked&#039;    =&gt; _n( &#039;%s product not updated, somebody is editing it.&#039;, &#039;%s products not updated, somebody is editing them.&#039;, $bulk_counts[&#039;locked&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: product count */
			&#039;deleted&#039;   =&gt; _n( &#039;%s product permanently deleted.&#039;, &#039;%s products permanently deleted.&#039;, $bulk_counts[&#039;deleted&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: product count */
			&#039;trashed&#039;   =&gt; _n( &#039;%s product moved to the Trash.&#039;, &#039;%s products moved to the Trash.&#039;, $bulk_counts[&#039;trashed&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: product count */
			&#039;untrashed&#039; =&gt; _n( &#039;%s product restored from the Trash.&#039;, &#039;%s products restored from the Trash.&#039;, $bulk_counts[&#039;untrashed&#039;], &#039;woocommerce&#039; ),
		);

		$bulk_messages[&#039;shop_order&#039;] = array(
			/* translators: %s: order count */
			&#039;updated&#039;   =&gt; _n( &#039;%s order updated.&#039;, &#039;%s orders updated.&#039;, $bulk_counts[&#039;updated&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: order count */
			&#039;locked&#039;    =&gt; _n( &#039;%s order not updated, somebody is editing it.&#039;, &#039;%s orders not updated, somebody is editing them.&#039;, $bulk_counts[&#039;locked&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: order count */
			&#039;deleted&#039;   =&gt; _n( &#039;%s order permanently deleted.&#039;, &#039;%s orders permanently deleted.&#039;, $bulk_counts[&#039;deleted&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: order count */
			&#039;trashed&#039;   =&gt; _n( &#039;%s order moved to the Trash.&#039;, &#039;%s orders moved to the Trash.&#039;, $bulk_counts[&#039;trashed&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: order count */
			&#039;untrashed&#039; =&gt; _n( &#039;%s order restored from the Trash.&#039;, &#039;%s orders restored from the Trash.&#039;, $bulk_counts[&#039;untrashed&#039;], &#039;woocommerce&#039; ),
		);

		$bulk_messages[&#039;shop_coupon&#039;] = array(
			/* translators: %s: coupon count */
			&#039;updated&#039;   =&gt; _n( &#039;%s coupon updated.&#039;, &#039;%s coupons updated.&#039;, $bulk_counts[&#039;updated&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: coupon count */
			&#039;locked&#039;    =&gt; _n( &#039;%s coupon not updated, somebody is editing it.&#039;, &#039;%s coupons not updated, somebody is editing them.&#039;, $bulk_counts[&#039;locked&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: coupon count */
			&#039;deleted&#039;   =&gt; _n( &#039;%s coupon permanently deleted.&#039;, &#039;%s coupons permanently deleted.&#039;, $bulk_counts[&#039;deleted&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: coupon count */
			&#039;trashed&#039;   =&gt; _n( &#039;%s coupon moved to the Trash.&#039;, &#039;%s coupons moved to the Trash.&#039;, $bulk_counts[&#039;trashed&#039;], &#039;woocommerce&#039; ),
			/* translators: %s: coupon count */
			&#039;untrashed&#039; =&gt; _n( &#039;%s coupon restored from the Trash.&#039;, &#039;%s coupons restored from the Trash.&#039;, $bulk_counts[&#039;untrashed&#039;], &#039;woocommerce&#039; ),
		);

		return $bulk_messages;
	}

	/**
	 * Custom bulk edit - form.
	 *
	 * @param string $column_name Column being shown.
	 * @param string $post_type Post type being shown.
	 */
	public function bulk_edit( $column_name, $post_type ) {
		if ( &#039;price&#039; !== $column_name || &#039;product&#039; !== $post_type ) {
			return;
		}

		$shipping_class = get_terms(
			&#039;product_shipping_class&#039;,
			array(
				&#039;hide_empty&#039; =&gt; false,
			)
		);

		include WC()-&gt;plugin_path() . &#039;/includes/admin/views/html-bulk-edit-product.php&#039;;
	}

	/**
	 * Custom quick edit - form.
	 *
	 * @param string $column_name Column being shown.
	 * @param string $post_type Post type being shown.
	 */
	public function quick_edit( $column_name, $post_type ) {
		if ( &#039;price&#039; !== $column_name || &#039;product&#039; !== $post_type ) {
			return;
		}

		$shipping_class = get_terms(
			&#039;product_shipping_class&#039;,
			array(
				&#039;hide_empty&#039; =&gt; false,
			)
		);

		include WC()-&gt;plugin_path() . &#039;/includes/admin/views/html-quick-edit-product.php&#039;;
	}

	/**
	 * Offers a way to hook into save post without causing an infinite loop
	 * when quick/bulk saving product info.
	 *
	 * @since 3.0.0
	 * @param int    $post_id Post ID being saved.
	 * @param object $post Post object being saved.
	 */
	public function bulk_and_quick_edit_hook( $post_id, $post ) {
		remove_action( &#039;save_post&#039;, array( $this, &#039;bulk_and_quick_edit_hook&#039; ) );
		do_action( &#039;woocommerce_product_bulk_and_quick_edit&#039;, $post_id, $post );
		add_action( &#039;save_post&#039;, array( $this, &#039;bulk_and_quick_edit_hook&#039; ), 10, 2 );
	}

	/**
	 * Quick and bulk edit saving.
	 *
	 * @param int    $post_id Post ID being saved.
	 * @param object $post Post object being saved.
	 * @return int
	 */
	public function bulk_and_quick_edit_save_post( $post_id, $post ) {
		$request_data = $this-&gt;request_data();

		// If this is an autosave, our form has not been submitted, so we don&#039;t want to do anything.
		if ( Constants::is_true( &#039;DOING_AUTOSAVE&#039; ) ) {
			return $post_id;
		}

		// Don&#039;t save revisions and autosaves.
		if ( wp_is_post_revision( $post_id ) || wp_is_post_autosave( $post_id ) || &#039;product&#039; !== $post-&gt;post_type || ! current_user_can( &#039;edit_post&#039;, $post_id ) ) {
			return $post_id;
		}

		// Check nonce.
		// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized, WordPress.Security.ValidatedSanitizedInput.MissingUnslash
		if ( ! isset( $request_data[&#039;woocommerce_quick_edit_nonce&#039;] ) || ! wp_verify_nonce( $request_data[&#039;woocommerce_quick_edit_nonce&#039;], &#039;woocommerce_quick_edit_nonce&#039; ) ) {
			return $post_id;
		}

		// Get the product and save.
		$product = wc_get_product( $post );

		if ( ! empty( $request_data[&#039;woocommerce_quick_edit&#039;] ) ) { // WPCS: input var ok.
			$this-&gt;quick_edit_save( $post_id, $product );
		} else {
			$this-&gt;bulk_edit_save( $post_id, $product );
		}

		return $post_id;
	}

	/**
	 * Quick edit.
	 *
	 * @param int        $post_id Post ID being saved.
	 * @param WC_Product $product Product object.
	 */
	private function quick_edit_save( $post_id, $product ) {
		$request_data = $this-&gt;request_data();

		$data_store        = $product-&gt;get_data_store();
		$old_regular_price = $product-&gt;get_regular_price();
		$old_sale_price    = $product-&gt;get_sale_price();
		$input_to_props    = array(
			&#039;_weight&#039;     =&gt; &#039;weight&#039;,
			&#039;_length&#039;     =&gt; &#039;length&#039;,
			&#039;_width&#039;      =&gt; &#039;width&#039;,
			&#039;_height&#039;     =&gt; &#039;height&#039;,
			&#039;_visibility&#039; =&gt; &#039;catalog_visibility&#039;,
			&#039;_tax_class&#039;  =&gt; &#039;tax_class&#039;,
			&#039;_tax_status&#039; =&gt; &#039;tax_status&#039;,
		);

		foreach ( $input_to_props as $input_var =&gt; $prop ) {
			if ( isset( $request_data[ $input_var ] ) ) {
				$product-&gt;{&quot;set_{$prop}&quot;}( wc_clean( wp_unslash( $request_data[ $input_var ] ) ) );
			}
		}

		if ( isset( $request_data[&#039;_sku&#039;] ) ) {
			$sku = $product-&gt;get_sku();
			// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash
			$new_sku = (string) wc_clean( $request_data[&#039;_sku&#039;] );

			if ( $new_sku !== $sku ) {
				if ( ! empty( $new_sku ) ) {
					$unique_sku = wc_product_has_unique_sku( $post_id, $new_sku );
					if ( $unique_sku ) {
						$product-&gt;set_sku( wc_clean( wp_unslash( $new_sku ) ) );
					}
				} else {
					$product-&gt;set_sku( &#039;&#039; );
				}
			}
		}

		if ( ! empty( $request_data[&#039;_shipping_class&#039;] ) ) {
			if ( &#039;_no_shipping_class&#039; === $request_data[&#039;_shipping_class&#039;] ) {
				$product-&gt;set_shipping_class_id( 0 );
			} else {
				// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash
				$shipping_class_id = $data_store-&gt;get_shipping_class_id_by_slug( wc_clean( $request_data[&#039;_shipping_class&#039;] ) );
				$product-&gt;set_shipping_class_id( $shipping_class_id );
			}
		}

		$product-&gt;set_featured( isset( $request_data[&#039;_featured&#039;] ) );

		if ( $product-&gt;is_type( &#039;simple&#039; ) || $product-&gt;is_type( &#039;external&#039; ) ) {

			if ( isset( $request_data[&#039;_regular_price&#039;] ) ) {
				// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash
				$new_regular_price = ( &#039;&#039; === $request_data[&#039;_regular_price&#039;] ) ? &#039;&#039; : wc_format_decimal( $request_data[&#039;_regular_price&#039;] );
				$product-&gt;set_regular_price( $new_regular_price );
			} else {
				$new_regular_price = null;
			}
			if ( isset( $request_data[&#039;_sale_price&#039;] ) ) {
				// phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash
				$new_sale_price = ( &#039;&#039; === $request_data[&#039;_sale_price&#039;] ) ? &#039;&#039; : wc_format_decimal( $request_data[&#039;_sale_price&#039;] );
				$product-&gt;set_sale_price( $new_sale_price );
			} else {
				$new_sale_price = null;
			}

			// Handle price - remove dates and set to lowest.
			$price_changed = false;

			if ( ! is_null( $new_regular_price ) &amp;&amp; $new_regular_price !== $old_regular_price ) {
				$price_changed = true;
			} elseif ( ! is_null( $new_sale_price ) &amp;&amp; $new_sale_price !== $old_sale_price ) {
				$price_changed = true;
			}

			if ( $price_changed ) {
				$product-&gt;set_date_on_sale_to( &#039;&#039; );
				$product-&gt;set_date_on_sale_from( &#039;&#039; );
			}
		}

		// Handle Stock Data.
		// phpcs:disable WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
		$manage_stock = ! empty( $request_data[&#039;_manage_stock&#039;] ) &amp;&amp; &#039;grouped&#039; !== $product-&gt;get_type() ? &#039;yes&#039; : &#039;no&#039;;
		$backorders   = ! empty( $request_data[&#039;_backorders&#039;] ) ? wc_clean( $request_data[&#039;_backorders&#039;] ) : &#039;no&#039;;
		if ( ! empty( $request_data[&#039;_stock_status&#039;] ) ) {
			$stock_status = wc_clean( $request_data[&#039;_stock_status&#039;] );
		} else {
			$stock_status = $product-&gt;is_type( &#039;variable&#039; ) ? null : &#039;instock&#039;;
		}
		// phpcs:enable WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized

		$product-&gt;set_manage_stock( $manage_stock );

		if ( &#039;external&#039; !== $product-&gt;get_type() ) {
			$product-&gt;set_backorders( $backorders );
		}

		if ( &#039;yes&#039; === get_option( &#039;woocommerce_manage_stock&#039; ) ) {
			$stock_amount = &#039;yes&#039; === $manage_stock &amp;&amp; isset( $request_data[&#039;_stock&#039;] ) &amp;&amp; is_numeric( wp_unslash( $request_data[&#039;_stock&#039;] ) ) ? wc_stock_amount( wp_unslash( $request_data[&#039;_stock&#039;] ) ) : &#039;&#039;;
			$product-&gt;set_stock_quantity( $stock_amount );
		}

		$product = $this-&gt;maybe_update_stock_status( $product, $stock_status );

		$product-&gt;save();

		do_action( &#039;woocommerce_product_quick_edit_save&#039;, $product );
	}

	/**
	 * Bulk edit.
	 *
	 * @param int        $post_id Post ID being saved.
	 * @param WC_Product $product Product object.
	 */
	public function bulk_edit_save( $post_id, $product ) {
		// phpcs:disable WordPress.Security.ValidatedSanitizedInput.MissingUnslash

		$request_data = $this-&gt;request_data();

		$data_store = $product-&gt;get_data_store();

		if ( ! empty( $request_data[&#039;change_weight&#039;] ) &amp;&amp; isset( $request_data[&#039;_weight&#039;] ) ) {
			$product-&gt;set_weight( wc_clean( wp_unslash( $request_data[&#039;_weight&#039;] ) ) );
		}

		if ( ! empty( $request_data[&#039;change_dimensions&#039;] ) ) {
			if ( isset( $request_data[&#039;_length&#039;] ) ) {
				$product-&gt;set_length( wc_clean( wp_unslash( $request_data[&#039;_length&#039;] ) ) );
			}
			if ( isset( $request_data[&#039;_width&#039;] ) ) {
				$product-&gt;set_width( wc_clean( wp_unslash( $request_data[&#039;_width&#039;] ) ) );
			}
			if ( isset( $request_data[&#039;_height&#039;] ) ) {
				$product-&gt;set_height( wc_clean( wp_unslash( $request_data[&#039;_height&#039;] ) ) );
			}
		}

		if ( ! empty( $request_data[&#039;_tax_status&#039;] ) ) {
			$product-&gt;set_tax_status( wc_clean( $request_data[&#039;_tax_status&#039;] ) );
		}

		if ( ! empty( $request_data[&#039;_tax_class&#039;] ) ) {
			$tax_class = wc_clean( wp_unslash( $request_data[&#039;_tax_class&#039;] ) );
			if ( &#039;standard&#039; === $tax_class ) {
				$tax_class = &#039;&#039;;
			}
			$product-&gt;set_tax_class( $tax_class );
		}

		if ( ! empty( $request_data[&#039;_shipping_class&#039;] ) ) {
			if ( &#039;_no_shipping_class&#039; === $request_data[&#039;_shipping_class&#039;] ) {
				$product-&gt;set_shipping_class_id( 0 );
			} else {
				$shipping_class_id = $data_store-&gt;get_shipping_class_id_by_slug( wc_clean( $request_data[&#039;_shipping_class&#039;] ) );
				$product-&gt;set_shipping_class_id( $shipping_class_id );
			}
		}

		if ( ! empty( $request_data[&#039;_visibility&#039;] ) ) {
			$product-&gt;set_catalog_visibility( wc_clean( $request_data[&#039;_visibility&#039;] ) );
		}

		if ( ! empty( $request_data[&#039;_featured&#039;] ) ) {
			// phpcs:disable WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
			$product-&gt;set_featured( wp_unslash( $request_data[&#039;_featured&#039;] ) );
			// phpcs:enable WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
		}

		if ( ! empty( $request_data[&#039;_sold_individually&#039;] ) ) {
			if ( &#039;yes&#039; === $request_data[&#039;_sold_individually&#039;] ) {
				$product-&gt;set_sold_individually( &#039;yes&#039; );
			} else {
				$product-&gt;set_sold_individually( &#039;&#039; );
			}
		}

		// Handle price - remove dates and set to lowest.
		$change_price_product_types    = apply_filters( &#039;woocommerce_bulk_edit_save_price_product_types&#039;, array( &#039;simple&#039;, &#039;external&#039; ) );
		$can_product_type_change_price = false;
		foreach ( $change_price_product_types as $product_type ) {
			if ( $product-&gt;is_type( $product_type ) ) {
				$can_product_type_change_price = true;
				break;
			}
		}

		if ( $can_product_type_change_price ) {
			$regular_price_changed = $this-&gt;set_new_price( $product, &#039;regular&#039; );
			$sale_price_changed    = $this-&gt;set_new_price( $product, &#039;sale&#039; );

			if ( $regular_price_changed || $sale_price_changed ) {
				$product-&gt;set_date_on_sale_to( &#039;&#039; );
				$product-&gt;set_date_on_sale_from( &#039;&#039; );

				if ( $product-&gt;get_regular_price() &lt; $product-&gt;get_sale_price() ) {
					$product-&gt;set_sale_price( &#039;&#039; );
				}
			}
		}

		// Handle Stock Data.
		$was_managing_stock = $product-&gt;get_manage_stock() ? &#039;yes&#039; : &#039;no&#039;;
		$backorders         = $product-&gt;get_backorders();
		$backorders         = ! empty( $request_data[&#039;_backorders&#039;] ) ? wc_clean( $request_data[&#039;_backorders&#039;] ) : $backorders;

		if ( ! empty( $request_data[&#039;_manage_stock&#039;] ) ) {
			$manage_stock = &#039;yes&#039; === wc_clean( $request_data[&#039;_manage_stock&#039;] ) &amp;&amp; &#039;grouped&#039; !== $product-&gt;get_type() ? &#039;yes&#039; : &#039;no&#039;;
		} else {
			$manage_stock = $was_managing_stock;
		}

		$stock_amount = &#039;yes&#039; === $manage_stock &amp;&amp; ! empty( $request_data[&#039;change_stock&#039;] ) &amp;&amp; isset( $request_data[&#039;_stock&#039;] ) ? wc_stock_amount( $request_data[&#039;_stock&#039;] ) : $product-&gt;get_stock_quantity();

		$product-&gt;set_manage_stock( $manage_stock );

		if ( &#039;external&#039; !== $product-&gt;get_type() ) {
			$product-&gt;set_backorders( $backorders );
		}

		if ( &#039;yes&#039; === get_option( &#039;woocommerce_manage_stock&#039; ) ) {
			$change_stock = absint( $request_data[&#039;change_stock&#039;] );
			switch ( $change_stock ) {
				case 2:
					wc_update_product_stock( $product, $stock_amount, &#039;increase&#039;, true );
					break;
				case 3:
					wc_update_product_stock( $product, $stock_amount, &#039;decrease&#039;, true );
					break;
				default:
					wc_update_product_stock( $product, $stock_amount, &#039;set&#039;, true );
					break;
			}
		} else {
			// Reset values if WooCommerce Setting - Manage Stock status is disabled.
			$product-&gt;set_stock_quantity( &#039;&#039; );
			$product-&gt;set_manage_stock( &#039;no&#039; );
		}

		$stock_status = empty( $request_data[&#039;_stock_status&#039;] ) ? null : wc_clean( $request_data[&#039;_stock_status&#039;] );
		$product      = $this-&gt;maybe_update_stock_status( $product, $stock_status );

		$product-&gt;save();

		do_action( &#039;woocommerce_product_bulk_edit_save&#039;, $product );

		// phpcs:enable WordPress.Security.ValidatedSanitizedInput.MissingUnslash
	}

	/**
	 * Disable the auto-save functionality for Orders.
	 */
	public function disable_autosave() {
		global $post;

		if ( $post &amp;&amp; in_array( get_post_type( $post-&gt;ID ), wc_get_order_types( &#039;order-meta-boxes&#039; ), true ) ) {
			wp_dequeue_script( &#039;autosave&#039; );
		}
	}

	/**
	 * Output extra data on post forms.
	 *
	 * @param WP_Post $post Current post object.
	 */
	public function edit_form_top( $post ) {
		echo &#039;&lt;input type=&quot;hidden&quot; id=&quot;original_post_title&quot; name=&quot;original_post_title&quot; value=&quot;&#039; . esc_attr( $post-&gt;post_title ) . &#039;&quot; /&gt;&#039;;
	}

	/**
	 * Change title boxes in admin.
	 *
	 * @param string  $text Text to shown.
	 * @param WP_Post $post Current post object.
	 * @return string
	 */
	public function enter_title_here( $text, $post ) {
		switch ( $post-&gt;post_type ) {
			case &#039;product&#039;:
				$text = esc_html__( &#039;Product name&#039;, &#039;woocommerce&#039; );
				break;
			case &#039;shop_coupon&#039;:
				$text = esc_html__( &#039;Coupon code&#039;, &#039;woocommerce&#039; );
				break;
		}
		return $text;
	}

	/**
	 * Print coupon description textarea field.
	 *
	 * @param WP_Post $post Current post object.
	 */
	public function edit_form_after_title( $post ) {
		// phpcs:disable WordPress.Security.EscapeOutput.OutputNotEscaped
		if ( &#039;shop_coupon&#039; === $post-&gt;post_type ) {
			?&gt;
			&lt;textarea id=&quot;woocommerce-coupon-description&quot; name=&quot;excerpt&quot; cols=&quot;5&quot; rows=&quot;2&quot; placeholder=&quot;&lt;?php esc_attr_e( &#039;Description (optional)&#039;, &#039;woocommerce&#039; ); ?&gt;&quot;&gt;&lt;?php echo $post-&gt;post_excerpt; ?&gt;&lt;/textarea&gt;
			&lt;?php
		}
		// phpcs:enable WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Hidden default Meta-Boxes.
	 *
	 * @param  array  $hidden Hidden boxes.
	 * @param  object $screen Current screen.
	 * @return array
	 */
	public function hidden_meta_boxes( $hidden, $screen ) {
		if ( &#039;product&#039; === $screen-&gt;post_type &amp;&amp; &#039;post&#039; === $screen-&gt;base ) {
			$hidden = array_merge( $hidden, array( &#039;postcustom&#039; ) );
		}

		return $hidden;
	}

	/**
	 * Output product visibility options.
	 */
	public function product_data_visibility() {
		global $post, $thepostid, $product_object;

		if ( &#039;product&#039; !== $post-&gt;post_type ) {
			return;
		}

		$thepostid          = $post-&gt;ID;
		$product_object     = $thepostid ? wc_get_product( $thepostid ) : new WC_Product();
		$current_visibility = $product_object-&gt;get_catalog_visibility();
		$current_featured   = wc_bool_to_string( $product_object-&gt;get_featured() );
		$visibility_options = wc_get_product_visibility_options();
		?&gt;
		&lt;div class=&quot;misc-pub-section&quot; id=&quot;catalog-visibility&quot;&gt;
			&lt;?php esc_html_e( &#039;Catalog visibility:&#039;, &#039;woocommerce&#039; ); ?&gt;
			&lt;strong id=&quot;catalog-visibility-display&quot;&gt;
				&lt;?php

				echo isset( $visibility_options[ $current_visibility ] ) ? esc_html( $visibility_options[ $current_visibility ] ) : esc_html( $current_visibility );

				if ( &#039;yes&#039; === $current_featured ) {
					echo &#039;, &#039; . esc_html__( &#039;Featured&#039;, &#039;woocommerce&#039; );
				}
				?&gt;
			&lt;/strong&gt;

			&lt;a href=&quot;#catalog-visibility&quot; class=&quot;edit-catalog-visibility hide-if-no-js&quot;&gt;&lt;?php esc_html_e( &#039;Edit&#039;, &#039;woocommerce&#039; ); ?&gt;&lt;/a&gt;

			&lt;div id=&quot;catalog-visibility-select&quot; class=&quot;hide-if-js&quot;&gt;

				&lt;input type=&quot;hidden&quot; name=&quot;current_visibility&quot; id=&quot;current_visibility&quot; value=&quot;&lt;?php echo esc_attr( $current_visibility ); ?&gt;&quot; /&gt;
				&lt;input type=&quot;hidden&quot; name=&quot;current_featured&quot; id=&quot;current_featured&quot; value=&quot;&lt;?php echo esc_attr( $current_featured ); ?&gt;&quot; /&gt;

				&lt;?php
				echo &#039;&lt;p&gt;&#039; . esc_html__( &#039;This setting determines which shop pages products will be listed on.&#039;, &#039;woocommerce&#039; ) . &#039;&lt;/p&gt;&#039;;

				foreach ( $visibility_options as $name =&gt; $label ) {
					echo &#039;&lt;input type=&quot;radio&quot; name=&quot;_visibility&quot; id=&quot;_visibility_&#039; . esc_attr( $name ) . &#039;&quot; value=&quot;&#039; . esc_attr( $name ) . &#039;&quot; &#039; . checked( $current_visibility, $name, false ) . &#039; data-label=&quot;&#039; . esc_attr( $label ) . &#039;&quot; /&gt; &lt;label for=&quot;_visibility_&#039; . esc_attr( $name ) . &#039;&quot; class=&quot;selectit&quot;&gt;&#039; . esc_html( $label ) . &#039;&lt;/label&gt;&lt;br /&gt;&#039;;
				}

				echo &#039;&lt;br /&gt;&lt;input type=&quot;checkbox&quot; name=&quot;_featured&quot; id=&quot;_featured&quot; &#039; . checked( $current_featured, &#039;yes&#039;, false ) . &#039; /&gt; &lt;label for=&quot;_featured&quot;&gt;&#039; . esc_html__( &#039;This is a featured product&#039;, &#039;woocommerce&#039; ) . &#039;&lt;/label&gt;&lt;br /&gt;&#039;;
				?&gt;
				&lt;p&gt;
					&lt;a href=&quot;#catalog-visibility&quot; class=&quot;save-post-visibility hide-if-no-js button&quot;&gt;&lt;?php esc_html_e( &#039;OK&#039;, &#039;woocommerce&#039; ); ?&gt;&lt;/a&gt;
					&lt;a href=&quot;#catalog-visibility&quot; class=&quot;cancel-post-visibility hide-if-no-js&quot;&gt;&lt;?php esc_html_e( &#039;Cancel&#039;, &#039;woocommerce&#039; ); ?&gt;&lt;/a&gt;
				&lt;/p&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;?php
	}

	/**
	 * Change upload dir for downloadable files.
	 *
	 * @param array $pathdata Array of paths.
	 * @return array
	 */
	public function upload_dir( $pathdata ) {
		// phpcs:disable WordPress.Security.NonceVerification.Missing
		if ( isset( $_POST[&#039;type&#039;] ) &amp;&amp; &#039;downloadable_product&#039; === $_POST[&#039;type&#039;] ) {

			if ( empty( $pathdata[&#039;subdir&#039;] ) ) {
				$pathdata[&#039;path&#039;]   = $pathdata[&#039;path&#039;] . &#039;/woocommerce_uploads&#039;;
				$pathdata[&#039;url&#039;]    = $pathdata[&#039;url&#039;] . &#039;/woocommerce_uploads&#039;;
				$pathdata[&#039;subdir&#039;] = &#039;/woocommerce_uploads&#039;;
			} else {
				$new_subdir = &#039;/woocommerce_uploads&#039; . $pathdata[&#039;subdir&#039;];

				$pathdata[&#039;path&#039;]   = str_replace( $pathdata[&#039;subdir&#039;], $new_subdir, $pathdata[&#039;path&#039;] );
				$pathdata[&#039;url&#039;]    = str_replace( $pathdata[&#039;subdir&#039;], $new_subdir, $pathdata[&#039;url&#039;] );
				$pathdata[&#039;subdir&#039;] = str_replace( $pathdata[&#039;subdir&#039;], $new_subdir, $pathdata[&#039;subdir&#039;] );
			}
		}
		return $pathdata;
		// phpcs:enable WordPress.Security.NonceVerification.Missing
	}

	/**
	 * Change filename for WooCommerce uploads and prepend unique chars for security.
	 *
	 * @param string $full_filename Original filename.
	 * @param string $ext           Extension of file.
	 * @param string $dir           Directory path.
	 *
	 * @return string New filename with unique hash.
	 * @since 4.0
	 */
	public function update_filename( $full_filename, $ext, $dir ) {
		// phpcs:disable WordPress.Security.NonceVerification.Missing
		if ( ! isset( $_POST[&#039;type&#039;] ) || ! &#039;downloadable_product&#039; === $_POST[&#039;type&#039;] ) {
			return $full_filename;
		}

		if ( ! strpos( $dir, &#039;woocommerce_uploads&#039; ) ) {
			return $full_filename;
		}

		if ( &#039;no&#039; === get_option( &#039;woocommerce_downloads_add_hash_to_filename&#039; ) ) {
			return $full_filename;
		}

		return $this-&gt;unique_filename( $full_filename, $ext );
		// phpcs:enable WordPress.Security.NonceVerification.Missing
	}

	/**
	 * Change filename to append random text.
	 *
	 * @param string $full_filename Original filename with extension.
	 * @param string $ext           Extension.
	 *
	 * @return string Modified filename.
	 */
	public function unique_filename( $full_filename, $ext ) {
		$ideal_random_char_length = 6;   // Not going with a larger length because then downloaded filename will not be pretty.
		$max_filename_length      = 255; // Max file name length for most file systems.
		$length_to_prepend        = min( $ideal_random_char_length, $max_filename_length - strlen( $full_filename ) - 1 );

		if ( 1 &gt; $length_to_prepend ) {
			return $full_filename;
		}

		$suffix   = strtolower( wp_generate_password( $length_to_prepend, false, false ) );
		$filename = $full_filename;

		if ( strlen( $ext ) &gt; 0 ) {
			$filename = substr( $filename, 0, strlen( $filename ) - strlen( $ext ) );
		}

		$full_filename = str_replace(
			$filename,
			&quot;$filename-$suffix&quot;,
			$full_filename
		);

		return $full_filename;
	}

	/**
	 * Run a filter when uploading a downloadable product.
	 */
	public function woocommerce_media_upload_downloadable_product() {
		do_action( &#039;media_upload_file&#039; );
	}

	/**
	 * Grant downloadable file access to any newly added files on any existing.
	 * orders for this product that have previously been granted downloadable file access.
	 *
	 * @param int   $product_id product identifier.
	 * @param int   $variation_id optional product variation identifier.
	 * @param array $downloadable_files newly set files.
	 * @deprecated 3.3.0 and moved to post-data class.
	 */
	public function process_product_file_download_paths( $product_id, $variation_id, $downloadable_files ) {
		wc_deprecated_function( &#039;WC_Admin_Post_Types::process_product_file_download_paths&#039;, &#039;3.3&#039;, &#039;&#039; );
		WC_Post_Data::process_product_file_download_paths( $product_id, $variation_id, $downloadable_files );
	}

	/**
	 * When editing the shop page, we should hide templates.
	 *
	 * @param array   $page_templates Templates array.
	 * @param string  $theme Classname.
	 * @param WP_Post $post The current post object.
	 * @return array
	 */
	public function hide_cpt_archive_templates( $page_templates, $theme, $post ) {
		$shop_page_id = wc_get_page_id( &#039;shop&#039; );

		if ( $post &amp;&amp; absint( $post-&gt;ID ) === $shop_page_id ) {
			$page_templates = array();
		}

		return $page_templates;
	}

	/**
	 * Show a notice above the CPT archive.
	 *
	 * @param WP_Post $post The current post object.
	 */
	public function show_cpt_archive_notice( $post ) {
		$shop_page_id = wc_get_page_id( &#039;shop&#039; );

		if ( $post &amp;&amp; absint( $post-&gt;ID ) === $shop_page_id ) {
			echo &#039;&lt;div class=&quot;notice notice-info&quot;&gt;&#039;;
			/* translators: %s: URL to read more about the shop page. */
			echo &#039;&lt;p&gt;&#039; . sprintf( wp_kses_post( __( &#039;This is the WooCommerce shop page. The shop page is a special archive that lists your products. &lt;a href=&quot;%s&quot;&gt;You can read more about this here&lt;/a&gt;.&#039;, &#039;woocommerce&#039; ) ), &#039;https://docs.woocommerce.com/document/woocommerce-pages/#section-4&#039; ) . &#039;&lt;/p&gt;&#039;;
			echo &#039;&lt;/div&gt;&#039;;
		}
	}

	/**
	 * Add a post display state for special WC pages in the page list table.
	 *
	 * @param array   $post_states An array of post display states.
	 * @param WP_Post $post        The current post object.
	 */
	public function add_display_post_states( $post_states, $post ) {
		if ( wc_get_page_id( &#039;shop&#039; ) === $post-&gt;ID ) {
			$post_states[&#039;wc_page_for_shop&#039;] = __( &#039;Shop Page&#039;, &#039;woocommerce&#039; );
		}

		if ( wc_get_page_id( &#039;cart&#039; ) === $post-&gt;ID ) {
			$post_states[&#039;wc_page_for_cart&#039;] = __( &#039;Cart Page&#039;, &#039;woocommerce&#039; );
		}

		if ( wc_get_page_id( &#039;checkout&#039; ) === $post-&gt;ID ) {
			$post_states[&#039;wc_page_for_checkout&#039;] = __( &#039;Checkout Page&#039;, &#039;woocommerce&#039; );
		}

		if ( wc_get_page_id( &#039;myaccount&#039; ) === $post-&gt;ID ) {
			$post_states[&#039;wc_page_for_myaccount&#039;] = __( &#039;My Account Page&#039;, &#039;woocommerce&#039; );
		}

		if ( wc_get_page_id( &#039;terms&#039; ) === $post-&gt;ID ) {
			$post_states[&#039;wc_page_for_terms&#039;] = __( &#039;Terms and Conditions Page&#039;, &#039;woocommerce&#039; );
		}

		return $post_states;
	}

	/**
	 * Apply product type constraints to stock status.
	 *
	 * @param WC_Product  $product The product whose stock status will be adjusted.
	 * @param string|null $stock_status The stock status to use for adjustment, or null if no new stock status has been supplied in the request.
	 * @return WC_Product The supplied product, or the synced product if it was a variable product.
	 */
	private function maybe_update_stock_status( $product, $stock_status ) {
		if ( $product-&gt;is_type( &#039;external&#039; ) ) {
			// External products are always in stock.
			$product-&gt;set_stock_status( &#039;instock&#039; );
		} elseif ( isset( $stock_status ) ) {
			if ( $product-&gt;is_type( &#039;variable&#039; ) &amp;&amp; ! $product-&gt;get_manage_stock() ) {
				// Stock status is determined by children.
				foreach ( $product-&gt;get_children() as $child_id ) {
					$child = wc_get_product( $child_id );
					if ( ! $product-&gt;get_manage_stock() ) {
						$child-&gt;set_stock_status( $stock_status );
						$child-&gt;save();
					}
				}
				$product = WC_Product_Variable::sync( $product, false );
			} else {
				$product-&gt;set_stock_status( $stock_status );
			}
		}

		return $product;
	}

	/**
	 * Set the new regular or sale price if requested.
	 *
	 * @param WC_Product $product The product to set the new price for.
	 * @param string     $price_type &#039;regular&#039; or &#039;sale&#039;.
	 * @return bool true if a new price has been set, false otherwise.
	 */
	private function set_new_price( $product, $price_type ) {
		// phpcs:disable WordPress.Security.NonceVerification.Recommended

		$request_data = $this-&gt;request_data();

		if ( empty( $request_data[ &quot;change_{$price_type}_price&quot; ] ) || ! isset( $request_data[ &quot;_{$price_type}_price&quot; ] ) ) {
			return false;
		}

		$old_price     = (float) $product-&gt;{&quot;get_{$price_type}_price&quot;}();
		$price_changed = false;

		$change_price  = absint( $request_data[ &quot;change_{$price_type}_price&quot; ] );
		$raw_price     = wc_clean( wp_unslash( $request_data[ &quot;_{$price_type}_price&quot; ] ) );
		$is_percentage = (bool) strstr( $raw_price, &#039;%&#039; );
		$price         = wc_format_decimal( $raw_price );

		switch ( $change_price ) {
			case 1:
				$new_price = $price;
				break;
			case 2:
				if ( $is_percentage ) {
					$percent   = $price / 100;
					$new_price = $old_price + ( $old_price * $percent );
				} else {
					$new_price = $old_price + $price;
				}
				break;
			case 3:
				if ( $is_percentage ) {
					$percent   = $price / 100;
					$new_price = max( 0, $old_price - ( $old_price * $percent ) );
				} else {
					$new_price = max( 0, $old_price - $price );
				}
				break;
			case 4:
				if ( &#039;sale&#039; !== $price_type ) {
					break;
				}
				$regular_price = $product-&gt;get_regular_price();
				if ( $is_percentage &amp;&amp; is_numeric( $regular_price ) ) {
					$percent   = $price / 100;
					$new_price = max( 0, $regular_price - ( NumberUtil::round( $regular_price * $percent, wc_get_price_decimals() ) ) );
				} else {
					$new_price = max( 0, (float) $regular_price - (float) $price );
				}
				break;

			default:
				break;
		}

		if ( isset( $new_price ) &amp;&amp; $new_price !== $old_price ) {
			$price_changed = true;
			$new_price     = NumberUtil::round( $new_price, wc_get_price_decimals() );
			$product-&gt;{&quot;set_{$price_type}_price&quot;}( $new_price );
		}

		return $price_changed;

		// phpcs:disable WordPress.Security.NonceVerification.Recommended
	}

	/**
	 * Get the current request data ($_REQUEST superglobal).
	 * This method is added to ease unit testing.
	 *
	 * @return array The $_REQUEST superglobal.
	 */
	protected function request_data() {
		return $_REQUEST;
	}
}

new WC_Admin_Post_Types();
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>WooCommerce Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on August 24th, 2023 at 08:49 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1692866946"></script>
    <script src="../js/search.js?updated=1692866946"></script>
</body>
</html>
