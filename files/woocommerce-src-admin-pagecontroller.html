<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>WooCommerce Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1692866951">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1692866951">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.svg" alt="WooCommerce" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">WooCommerce Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/woocommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/woocommerce-admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/automattic-woocommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WooCommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WooCommerce-Classes.html"><abbr title="\WooCommerce\Classes">Classes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Abstracts.html"><abbr title="\WooCommerce\Abstracts">Abstracts</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Helper.html"><abbr title="\WooCommerce\Helper">Helper</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Views.html"><abbr title="\WooCommerce\Views">Views</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Templates.html"><abbr title="\WooCommerce\Templates">Templates</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Reports.html"><abbr title="\WooCommerce\Reports">Reports</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Blocks.html"><abbr title="\WooCommerce\Blocks">Blocks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-RestApi.html"><abbr title="\WooCommerce\RestApi">RestApi</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-CLI.html"><abbr title="\WooCommerce\CLI">CLI</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-l10n.html"><abbr title="\WooCommerce\l10n">l10n</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Webhooks.html"><abbr title="\WooCommerce\Webhooks">Webhooks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-DataStores.html"><abbr title="\WooCommerce\DataStores">DataStores</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Emails.html"><abbr title="\WooCommerce\Emails">Emails</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Export.html"><abbr title="\WooCommerce\Export">Export</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Gateways.html"><abbr title="\WooCommerce\Gateways">Gateways</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PayPal.html"><abbr title="\WooCommerce\PayPal">PayPal</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Import.html"><abbr title="\WooCommerce\Import">Import</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Integrations.html"><abbr title="\WooCommerce\Integrations">Integrations</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interfaces.html"><abbr title="\WooCommerce\Interfaces">Interfaces</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interface.html"><abbr title="\WooCommerce\Interface">Interface</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-LogHandlers.html"><abbr title="\WooCommerce\LogHandlers">LogHandlers</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PaymentTokens.html"><abbr title="\WooCommerce\PaymentTokens">PaymentTokens</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Utilities.html"><abbr title="\WooCommerce\Utilities">Utilities</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shipping.html"><abbr title="\WooCommerce\Shipping">Shipping</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shortcodes.html"><abbr title="\WooCommerce\Shortcodes">Shortcodes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Tracks.html"><abbr title="\WooCommerce\Tracks">Tracks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Traits.html"><abbr title="\WooCommerce\Traits">Traits</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Functions.html"><abbr title="\WooCommerce\Functions">Functions</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCom.html"><abbr title="\WooCommerce\WCCom">WCCom</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCOM.html"><abbr title="\WooCommerce\WCCOM">WCCOM</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Widgets.html"><abbr title="\WooCommerce\Widgets">Widgets</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Uninstaller.html"><abbr title="\WooCommerce\Uninstaller">Uninstaller</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceAdmin.html"><abbr title="\WoocommerceAdmin">WoocommerceAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceNavigation.html"><abbr title="\WoocommerceNavigation">WoocommerceNavigation</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/Automattic-WooCommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">PageController.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * PageController
 */

namespace Automattic\WooCommerce\Admin;

use Automattic\WooCommerce\Admin\Features\Navigation\Screen;
use Automattic\WooCommerce\Internal\Admin\Loader;

defined( &#039;ABSPATH&#039; ) || exit;

/**
 * PageController
 */
class PageController {
	/**
	 * App entry point.
	 */
	const APP_ENTRY_POINT = &#039;wc-admin&#039;;

	// JS-powered page root.
	const PAGE_ROOT = &#039;wc-admin&#039;;

	/**
	 * Singleton instance of self.
	 *
	 * @var PageController
	 */
	private static $instance = false;

	/**
	 * Current page ID (or false if not registered with this controller).
	 *
	 * @var string
	 */
	private $current_page = null;

	/**
	 * Registered pages
	 * Contains information (breadcrumbs, menu info) about JS powered pages and classic WooCommerce pages.
	 *
	 * @var array
	 */
	private $pages = array();

	/**
	 * We want a single instance of this class so we can accurately track registered menus and pages.
	 */
	public static function get_instance() {
		if ( ! self::$instance ) {
			self::$instance = new self();
		}

		return self::$instance;
	}

	/**
	 * Constructor.
	 * Hooks added here should be removed in `wc_admin_initialize` via the feature plugin.
	 */
	public function __construct() {
		add_action( &#039;admin_menu&#039;, array( $this, &#039;register_page_handler&#039; ) );
		add_action( &#039;admin_menu&#039;, array( $this, &#039;register_store_details_page&#039; ) );

		// priority is 20 to run after https://github.com/woocommerce/woocommerce/blob/a55ae325306fc2179149ba9b97e66f32f84fdd9c/includes/admin/class-wc-admin-menus.php#L165.
		add_action( &#039;admin_head&#039;, array( $this, &#039;remove_app_entry_page_menu_item&#039; ), 20 );
	}

	/**
	 * Connect an existing page to wc-admin.
	 *
	 * @param array $options {
	 *   Array describing the page.
	 *
	 *   @type string       id           Id to reference the page.
	 *   @type string|array title        Page title. Used in menus and breadcrumbs.
	 *   @type string|null  parent       Parent ID. Null for new top level page.
	 *   @type string       path         Path for this page. E.g. admin.php?page=wc-settings&amp;tab=checkout
	 *   @type string       capability   Capability needed to access the page.
	 *   @type string       icon         Icon. Dashicons helper class, base64-encoded SVG, or &#039;none&#039;.
	 *   @type int          position     Menu item position.
	 *   @type boolean      js_page      If this is a JS-powered page.
	 * }
	 */
	public function connect_page( $options ) {
		if ( ! is_array( $options[&#039;title&#039;] ) ) {
			$options[&#039;title&#039;] = array( $options[&#039;title&#039;] );
		}

		/**
		 * Filter the options when connecting or registering a page.
		 *
		 * Use the `js_page` option to determine if registering.
		 *
		 * @param array $options {
		 *   Array describing the page.
		 *
		 *   @type string       id           Id to reference the page.
		 *   @type string|array title        Page title. Used in menus and breadcrumbs.
		 *   @type string|null  parent       Parent ID. Null for new top level page.
		 *   @type string       screen_id    The screen ID that represents the connected page. (Not required for registering).
		 *   @type string       path         Path for this page. E.g. admin.php?page=wc-settings&amp;tab=checkout
		 *   @type string       capability   Capability needed to access the page.
		 *   @type string       icon         Icon. Dashicons helper class, base64-encoded SVG, or &#039;none&#039;.
		 *   @type int          position     Menu item position.
		 *   @type boolean      js_page      If this is a JS-powered page.
		 * }
		 */
		$options = apply_filters( &#039;woocommerce_navigation_connect_page_options&#039;, $options );

		// @todo check for null ID, or collision.
		$this-&gt;pages[ $options[&#039;id&#039;] ] = $options;
	}

	/**
	 * Determine the current page ID, if it was registered with this controller.
	 */
	public function determine_current_page() {
		$current_url       = &#039;&#039;;
		$current_screen_id = $this-&gt;get_current_screen_id();

		if ( isset( $_SERVER[&#039;REQUEST_URI&#039;] ) ) {
			$current_url = esc_url_raw( wp_unslash( $_SERVER[&#039;REQUEST_URI&#039;] ) );
		}

		$current_query = wp_parse_url( $current_url, PHP_URL_QUERY );
		parse_str( (string) $current_query, $current_pieces );
		$current_path  = empty( $current_pieces[&#039;page&#039;] ) ? &#039;&#039; : $current_pieces[&#039;page&#039;];
		$current_path .= empty( $current_pieces[&#039;path&#039;] ) ? &#039;&#039; : &#039;&amp;path=&#039; . $current_pieces[&#039;path&#039;];

		foreach ( $this-&gt;pages as $page ) {
			if ( isset( $page[&#039;js_page&#039;] ) &amp;&amp; $page[&#039;js_page&#039;] ) {
				// Check registered admin pages.
				if (
					$page[&#039;path&#039;] === $current_path
				) {
					$this-&gt;current_page = $page;
					return;
				}
			} else {
				// Check connected admin pages.
				if (
					isset( $page[&#039;screen_id&#039;] ) &amp;&amp;
					$page[&#039;screen_id&#039;] === $current_screen_id
				) {
					$this-&gt;current_page = $page;
					return;
				}
			}
		}
		$this-&gt;current_page = false;
	}


	/**
	 * Get breadcrumbs for WooCommerce Admin Page navigation.
	 *
	 * @return array Navigation pieces (breadcrumbs).
	 */
	public function get_breadcrumbs() {
		$current_page = $this-&gt;get_current_page();

		// Bail if this isn&#039;t a page registered with this controller.
		if ( false === $current_page ) {
			// Filter documentation below.
			return apply_filters( &#039;woocommerce_navigation_get_breadcrumbs&#039;, array( &#039;&#039; ), $current_page );
		}

		if ( 1 === count( $current_page[&#039;title&#039;] ) ) {
			$breadcrumbs = $current_page[&#039;title&#039;];
		} else {
			// If this page has multiple title pieces, only link the first one.
			$breadcrumbs = array_merge(
				array(
					array( $current_page[&#039;path&#039;], reset( $current_page[&#039;title&#039;] ) ),
				),
				array_slice( $current_page[&#039;title&#039;], 1 )
			);
		}

		if ( isset( $current_page[&#039;parent&#039;] ) ) {
			$parent_id = $current_page[&#039;parent&#039;];

			while ( $parent_id ) {
				if ( isset( $this-&gt;pages[ $parent_id ] ) ) {
					$parent = $this-&gt;pages[ $parent_id ];

					if ( 0 === strpos( $parent[&#039;path&#039;], self::PAGE_ROOT ) ) {
						$parent[&#039;path&#039;] = &#039;admin.php?page=&#039; . $parent[&#039;path&#039;];
					}

					array_unshift( $breadcrumbs, array( $parent[&#039;path&#039;], reset( $parent[&#039;title&#039;] ) ) );
					$parent_id = isset( $parent[&#039;parent&#039;] ) ? $parent[&#039;parent&#039;] : false;
				} else {
					$parent_id = false;
				}
			}
		}

		$woocommerce_breadcrumb = array( &#039;admin.php?page=&#039; . self::PAGE_ROOT, __( &#039;WooCommerce&#039;, &#039;woocommerce&#039; ) );

		array_unshift( $breadcrumbs, $woocommerce_breadcrumb );

		/**
		 * The navigation breadcrumbs for the current page.
		 *
		 * @param array         $breadcrumbs Navigation pieces (breadcrumbs).
		 * @param array|boolean $current_page The connected page data or false if not identified.
		 */
		return apply_filters( &#039;woocommerce_navigation_get_breadcrumbs&#039;, $breadcrumbs, $current_page );
	}

	/**
	 * Get the current page.
	 *
	 * @return array|boolean Current page or false if not registered with this controller.
	 */
	public function get_current_page() {
		// If &#039;current_screen&#039; hasn&#039;t fired yet, the current page calculation
		// will fail which causes `false` to be returned for all subsquent calls.
		if ( ! did_action( &#039;current_screen&#039; ) ) {
			_doing_it_wrong( __FUNCTION__, esc_html__( &#039;Current page retrieval should be called on or after the `current_screen` hook.&#039;, &#039;woocommerce&#039; ), &#039;0.16.0&#039; );
		}

		if ( is_null( $this-&gt;current_page ) ) {
			$this-&gt;determine_current_page();
		}

		return $this-&gt;current_page;
	}


	/**
	 * Returns the current screen ID.
	 *
	 * This is slightly different from WP&#039;s get_current_screen, in that it attaches an action,
	 * so certain pages like &#039;add new&#039; pages can have different breadcrumbs or handling.
	 * It also catches some more unique dynamic pages like taxonomy/attribute management.
	 *
	 * Format:
	 * - {$current_screen-&gt;action}-{$current_screen-&gt;action}-tab-section
	 * - {$current_screen-&gt;action}-{$current_screen-&gt;action}-tab
	 * - {$current_screen-&gt;action}-{$current_screen-&gt;action} if no tab is present
	 * - {$current_screen-&gt;action} if no action or tab is present
	 *
	 * @return string Current screen ID.
	 */
	public function get_current_screen_id() {
		$current_screen = get_current_screen();
		if ( ! $current_screen ) {
			// Filter documentation below.
			return apply_filters( &#039;woocommerce_navigation_current_screen_id&#039;, false, $current_screen );
		}

		$screen_pieces = array( $current_screen-&gt;id );

		if ( $current_screen-&gt;action ) {
			$screen_pieces[] = $current_screen-&gt;action;
		}

		if (
			! empty( $current_screen-&gt;taxonomy ) &amp;&amp;
			isset( $current_screen-&gt;post_type ) &amp;&amp;
			&#039;product&#039; === $current_screen-&gt;post_type
		) {
			// Editing a product attribute.
			if ( 0 === strpos( $current_screen-&gt;taxonomy, &#039;pa_&#039; ) ) {
				$screen_pieces = array( &#039;product_page_product_attribute-edit&#039; );
			}

			// Editing a product taxonomy term.
			if ( ! empty( $_GET[&#039;tag_ID&#039;] ) ) {
				$screen_pieces = array( $current_screen-&gt;taxonomy );
			}
		}

		// Pages with default tab values.
		$pages_with_tabs = apply_filters(
			&#039;woocommerce_navigation_pages_with_tabs&#039;,
			array(
				&#039;wc-reports&#039;  =&gt; &#039;orders&#039;,
				&#039;wc-settings&#039; =&gt; &#039;general&#039;,
				&#039;wc-status&#039;   =&gt; &#039;status&#039;,
				&#039;wc-addons&#039;   =&gt; &#039;browse-extensions&#039;,
			)
		);

		// Tabs that have sections as well.
		$wc_emails    = \WC_Emails::instance();
		$wc_email_ids = array_map( &#039;sanitize_title&#039;, array_keys( $wc_emails-&gt;get_emails() ) );

		$tabs_with_sections = apply_filters(
			&#039;woocommerce_navigation_page_tab_sections&#039;,
			array(
				&#039;products&#039;          =&gt; array( &#039;&#039;, &#039;inventory&#039;, &#039;downloadable&#039; ),
				&#039;shipping&#039;          =&gt; array( &#039;&#039;, &#039;options&#039;, &#039;classes&#039; ),
				&#039;checkout&#039;          =&gt; array( &#039;bacs&#039;, &#039;cheque&#039;, &#039;cod&#039;, &#039;paypal&#039; ),
				&#039;email&#039;             =&gt; $wc_email_ids,
				&#039;advanced&#039;          =&gt; array(
					&#039;&#039;,
					&#039;keys&#039;,
					&#039;webhooks&#039;,
					&#039;legacy_api&#039;,
					&#039;woocommerce_com&#039;,
				),
				&#039;browse-extensions&#039; =&gt; array( &#039;helper&#039; ),
			)
		);

		if ( ! empty( $_GET[&#039;page&#039;] ) ) {
			$page = wc_clean( wp_unslash( $_GET[&#039;page&#039;] ) );
			if ( in_array( $page, array_keys( $pages_with_tabs ) ) ) {
				if ( ! empty( $_GET[&#039;tab&#039;] ) ) {
					$tab = wc_clean( wp_unslash( $_GET[&#039;tab&#039;] ) );
				} else {
					$tab = $pages_with_tabs[ $page ];
				}

				$screen_pieces[] = $tab;

				if ( ! empty( $_GET[&#039;section&#039;] ) ) {
					$section = wc_clean( wp_unslash( $_GET[&#039;section&#039;] ) );
					if (
						isset( $tabs_with_sections[ $tab ] ) &amp;&amp;
						in_array( $section, array_keys( $tabs_with_sections[ $tab ] ) )
					) {
						$screen_pieces[] = $section;
					}
				}

				// Editing a shipping zone.
				if ( ( &#039;shipping&#039; === $tab ) &amp;&amp; isset( $_GET[&#039;zone_id&#039;] ) ) {
					$screen_pieces[] = &#039;edit_zone&#039;;
				}
			}
		}

		/**
		 * The current screen id.
		 *
		 * Used for identifying pages to render the WooCommerce Admin header.
		 *
		 * @param string|boolean $screen_id The screen id or false if not identified.
		 * @param WP_Screen      $current_screen The current WP_Screen.
		 */
		return apply_filters( &#039;woocommerce_navigation_current_screen_id&#039;, implode( &#039;-&#039;, $screen_pieces ), $current_screen );
	}

	/**
	 * Returns the path from an ID.
	 *
	 * @param  string $id  ID to get path for.
	 * @return string Path for the given ID, or the ID on lookup miss.
	 */
	public function get_path_from_id( $id ) {
		if ( isset( $this-&gt;pages[ $id ] ) &amp;&amp; isset( $this-&gt;pages[ $id ][&#039;path&#039;] ) ) {
			return $this-&gt;pages[ $id ][&#039;path&#039;];
		}
		return $id;
	}

	/**
	 * Returns true if we are on a page connected to this controller.
	 *
	 * @return boolean
	 */
	public function is_connected_page() {
		$current_page = $this-&gt;get_current_page();

		if ( false === $current_page ) {
			$is_connected_page = false;
		} else {
			$is_connected_page = isset( $current_page[&#039;js_page&#039;] ) ? ! $current_page[&#039;js_page&#039;] : true;
		}

		// Disable embed on the block editor.
		$current_screen = did_action( &#039;current_screen&#039; ) ? get_current_screen() : false;
		if ( ! empty( $current_screen ) &amp;&amp; method_exists( $current_screen, &#039;is_block_editor&#039; ) &amp;&amp; $current_screen-&gt;is_block_editor() ) {
			$is_connected_page = false;
		}

		/**
		 * Whether or not the current page is an existing page connected to this controller.
		 *
		 * Used to determine if the WooCommerce Admin header should be rendered.
		 *
		 * @param boolean       $is_connected_page True if the current page is connected.
		 * @param array|boolean $current_page The connected page data or false if not identified.
		 */
		return apply_filters( &#039;woocommerce_navigation_is_connected_page&#039;, $is_connected_page, $current_page );
	}

	/**
	 * Returns true if we are on a page registed with this controller.
	 *
	 * @return boolean
	 */
	public function is_registered_page() {
		$current_page = $this-&gt;get_current_page();

		if ( false === $current_page ) {
			$is_registered_page = false;
		} else {
			$is_registered_page = isset( $current_page[&#039;js_page&#039;] ) &amp;&amp; $current_page[&#039;js_page&#039;];
		}

		/**
		 * Whether or not the current page was registered with this controller.
		 *
		 * Used to determine if this is a JS-powered WooCommerce Admin page.
		 *
		 * @param boolean       $is_registered_page True if the current page was registered with this controller.
		 * @param array|boolean $current_page The registered page data or false if not identified.
		 */
		return apply_filters( &#039;woocommerce_navigation_is_registered_page&#039;, $is_registered_page, $current_page );
	}

	/**
	 * Adds a JS powered page to wc-admin.
	 *
	 * @param array $options {
	 *   Array describing the page.
	 *
	 *   @type string      id           Id to reference the page.
	 *   @type string      title        Page title. Used in menus and breadcrumbs.
	 *   @type string|null parent       Parent ID. Null for new top level page.
	 *   @type string      path         Path for this page, full path in app context; ex /analytics/report
	 *   @type string      capability   Capability needed to access the page.
	 *   @type string      icon         Icon. Dashicons helper class, base64-encoded SVG, or &#039;none&#039;.
	 *   @type int         position     Menu item position.
	 *   @type int         order        Navigation item order.
	 * }
	 */
	public function register_page( $options ) {
		$defaults = array(
			&#039;id&#039;         =&gt; null,
			&#039;parent&#039;     =&gt; null,
			&#039;title&#039;      =&gt; &#039;&#039;,
			&#039;capability&#039; =&gt; &#039;view_woocommerce_reports&#039;,
			&#039;path&#039;       =&gt; &#039;&#039;,
			&#039;icon&#039;       =&gt; &#039;&#039;,
			&#039;position&#039;   =&gt; null,
			&#039;js_page&#039;    =&gt; true,
		);

		$options = wp_parse_args( $options, $defaults );

		if ( 0 !== strpos( $options[&#039;path&#039;], self::PAGE_ROOT ) ) {
			$options[&#039;path&#039;] = self::PAGE_ROOT . &#039;&amp;path=&#039; . $options[&#039;path&#039;];
		}

		if ( is_null( $options[&#039;parent&#039;] ) ) {
			add_menu_page(
				$options[&#039;title&#039;],
				$options[&#039;title&#039;],
				$options[&#039;capability&#039;],
				$options[&#039;path&#039;],
				array( __CLASS__, &#039;page_wrapper&#039; ),
				$options[&#039;icon&#039;],
				intval( round( $options[&#039;position&#039;] ) )
			);
		} else {
			$parent_path = $this-&gt;get_path_from_id( $options[&#039;parent&#039;] );
			// @todo check for null path.
			add_submenu_page(
				$parent_path,
				$options[&#039;title&#039;],
				$options[&#039;title&#039;],
				$options[&#039;capability&#039;],
				$options[&#039;path&#039;],
				array( __CLASS__, &#039;page_wrapper&#039; )
			);
		}

		$this-&gt;connect_page( $options );
	}

	/**
	 * Get registered pages.
	 *
	 * @return array
	 */
	public function get_pages() {
		return $this-&gt;pages;
	}

	/**
	 * Set up a div for the app to render into.
	 */
	public static function page_wrapper() {
		Loader::page_wrapper();
	}

	/**
	 * Connects existing WooCommerce pages.
	 *
	 * @todo The entry point for the embed needs moved to this class as well.
	 */
	public function register_page_handler() {
		require_once WC_ADMIN_ABSPATH . &#039;includes/react-admin/connect-existing-pages.php&#039;;
	}

	/**
	 * Registers the store details (profiler) page.
	 */
	public function register_store_details_page() {
		wc_admin_register_page(
			array(
				&#039;title&#039;  =&gt; __( &#039;Setup Wizard&#039;, &#039;woocommerce&#039; ),
				&#039;parent&#039; =&gt; &#039;&#039;,
				&#039;path&#039;   =&gt; &#039;/setup-wizard&#039;,
			)
		);
	}

	/**
	 * Remove the menu item for the app entry point page.
	 */
	public function remove_app_entry_page_menu_item() {
		global $submenu;
		// User does not have capabilites to see the submenu.
		if ( ! current_user_can( &#039;manage_woocommerce&#039; ) || empty( $submenu[&#039;woocommerce&#039;] ) ) {
			return;
		}

		$wc_admin_key = null;
		foreach ( $submenu[&#039;woocommerce&#039;] as $submenu_key =&gt; $submenu_item ) {
			// Our app entry page menu item has no title.
			if ( is_null( $submenu_item[0] ) &amp;&amp; self::APP_ENTRY_POINT === $submenu_item[2] ) {
				$wc_admin_key = $submenu_key;
				break;
			}
		}

		if ( ! $wc_admin_key ) {
			return;
		}

		unset( $submenu[&#039;woocommerce&#039;][ $wc_admin_key ] );
	}

	/**
	 * Returns true if we are on a JS powered admin page or
	 * a &quot;classic&quot; (non JS app) powered admin page (an embedded page).
	 */
	public static function is_admin_or_embed_page() {
		return self::is_admin_page() || self::is_embed_page();
	}

	/**
	 * Returns true if we are on a JS powered admin page.
	 */
	public static function is_admin_page() {
		// phpcs:disable WordPress.Security.NonceVerification
		return isset( $_GET[&#039;page&#039;] ) &amp;&amp; &#039;wc-admin&#039; === $_GET[&#039;page&#039;];
		// phpcs:enable WordPress.Security.NonceVerification
	}

	/**
	 *  Returns true if we are on a &quot;classic&quot; (non JS app) powered admin page.
	 *
	 * TODO: See usage in `admin.php`. This needs refactored and implemented properly in core.
	 */
	public static function is_embed_page() {
		return wc_admin_is_connected_page() || ( ! self::is_admin_page() &amp;&amp; class_exists( &#039;Automattic\WooCommerce\Admin\Features\Navigation\Screen&#039; ) &amp;&amp; Screen::is_woocommerce_page() );
	}
}
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>WooCommerce Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on August 24th, 2023 at 08:49 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1692866951"></script>
    <script src="../js/search.js?updated=1692866951"></script>
</body>
</html>
